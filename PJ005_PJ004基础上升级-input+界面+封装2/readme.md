写python一段代码，用于读取文件夹ready里面的“ready.xlsx”A列的数据，按照A列的数据到PMIS导出表格，然后对数据进行汇总。cookie会改变，需要定期更新，更新方法：PORTAL登陆后进入PMIS，直接查看cookie里面的pmis.session.id即可。
<hr>
# 代码说明

## 1、请求导出表格的请求方案：
    由于系统需要校验是否有权限（涉及到cookie和防盗链问题，cookie：即相当于用户身份认证暂时存储在客户端有时限性过期时限；防盗链：即溯源上一级链接才允许请求。
    经测试，PMIS只需验证cookie），处理cookie的方案有2个：
    （1）用session模拟用户登陆，保持会话获取相应的权限，这里有一个技术难点未解决所以暂时未使用该方案。技术难点：经网页F12抓包查看，portal登陆可能涉及二次请求和密码加密传输，二次传输这里要详细看抓包的XHR；
    （2）请求头headers直接用cookie（本代码使用的方案），这种比较直接，缺点就是cookie过一段时间会时效，要重新抓包查找。

## 2、获取到文件流的处理方案尝试：
    因为网页F12查看到响应类型是application/octet-stream，而且自己请求到的数据经猜测也是Excel表格，所以需要处理响应返回的数据。
    （1）用openpyxl第三方库处理excel写入新的excel-方案失败；
    （2）用pandas第三方库将数据写入excel-方案失败；
    （3）直接将文件流写入新表格-方案成功（问GPT得到的方案）；
